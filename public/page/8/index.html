<!DOCTYPE HTML>
<html>
<head>
  <meta charset="utf-8">
  
  <title>第 8 页 - 三水清</title>
  <meta name="author" content="三水清">
  
  
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  
  <meta property="og:site_name" content="三水清"/>

  
    <meta property="og:image" content="undefined"/>
  

  <link href="/favicon.png" rel="icon">
  <link rel="alternate" href="atom.xml" title="三水清" type="application/atom+xml">
  <link rel="stylesheet" href="/css/style.css" media="screen" type="text/css">
  <!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
  
</head>


<body>
  <header id="header" class="inner"><div class="alignleft">
  <h1><a href="/">三水清</a></h1>
  <h2><a href="/">专注前端开发,分享Javascript/CSS/PHP等Web前端开发技巧</a></h2>
</div>
<nav id="main-nav" class="alignright">
  <ul>
    
      <li><a href="/">首页</a></li>
    
      <li><a href="/about">关于</a></li>
    
      <li><a href="https://github.com/ksky521">Github</a></li>
    
      <li><a href="http://weibo.com/sanshuiqing">新浪微博</a></li>
    
  </ul>
  <div class="clearfix"></div>
</nav>
<div class="clearfix"></div></header>
  <div id="content" class="inner">
    <div id="main-col" class="alignleft"><div id="wrapper">
  <article class="post">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
      
      
  
    <h1 class="title"><a href="/2011/04/22/使用javascript将xml解析为json/">使用javascript将XML解析为JSON</a></h1>
  

      <time datetime="2011-04-22T08:18:17.000Z"><a href="/2011/04/22/使用javascript将xml解析为json/">2011年4月22日</a></time>
    </header>
    <div class="entry">
      
        <p>今天看了<a href="http://davidwalsh.name/" target="_blank">David Walsh</a>一篇把XML格式转换为JSON格式的文章，感觉不错，简单的转载了过来。<br>下面是神奇的<strong>XML转JSON</strong>的javascript代码：</p>
<figure class="highlight lang-javascript"><table><tr><td class="gutter"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
</pre></td><td class="code"><pre>
	<span class="comment">// Changes XML to JSON</span>
<span class="function"><span class="keyword">function</span> <span class="title">xmlToJson</span><span class="params">(xml)</span> {</span>

	<span class="comment">// Create the return object</span>
	<span class="keyword">var</span> obj = {};

	<span class="keyword">if</span> (xml.nodeType == <span class="number">1</span>) { <span class="comment">// element</span>
		<span class="comment">// do attributes</span>
		<span class="keyword">if</span> (xml.attributes.length &gt; <span class="number">0</span>) {
		obj[<span class="string">"@attributes"</span>] = {};
			<span class="keyword">for</span> (<span class="keyword">var</span> j = <span class="number">0</span>; j &lt; xml.attributes.length; j++) {
				<span class="keyword">var</span> attribute = xml.attributes.item(j);
				obj[<span class="string">"@attributes"</span>][attribute.nodeName] = attribute.nodeValue;
			}
		}
	} <span class="keyword">else</span> <span class="keyword">if</span> (xml.nodeType == <span class="number">3</span>) { <span class="comment">// text</span>
		obj = xml.nodeValue;
	}

	<span class="comment">// do children</span>
	<span class="keyword">if</span> (xml.hasChildNodes()) {
		<span class="keyword">for</span>(<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; xml.childNodes.length; i++) {
			<span class="keyword">var</span> item = xml.childNodes.item(i);
			<span class="keyword">var</span> nodeName = item.nodeName;
			<span class="keyword">if</span> (<span class="keyword">typeof</span>(obj[nodeName]) == <span class="string">"undefined"</span>) {
				obj[nodeName] = xmlToJson(item);
			} <span class="keyword">else</span> {
				<span class="keyword">if</span> (<span class="keyword">typeof</span>(obj[nodeName].length) == <span class="string">"undefined"</span>) {
					<span class="keyword">var</span> old = obj[nodeName];
					obj[nodeName] = [];
					obj[nodeName].push(old);
				}
				obj[nodeName].push(xmlToJson(item));
			}
		}
	}
	<span class="keyword">return</span> obj;
};
</pre></td></tr></table></figure>

<p>
      
    </div>
    <footer>
      
        
          <div class="alignleft">
            <a href="/2011/04/22/使用javascript将xml解析为json/#more" class="more-link">全文</a>
          </div>
        
        
      
      

      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article class="post">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
      
      
  
    <h1 class="title"><a href="/2011/04/21/一道js正则笔试题/">一道js正则笔试题</a></h1>
  

      <time datetime="2011-04-20T22:12:51.000Z"><a href="/2011/04/21/一道js正则笔试题/">2011年4月21日</a></time>
    </header>
    <div class="entry">
      
        <h3>写在前面</h3>
<p>终于找到工作了，现在在新浪微博工作，谢谢这段时间来帮我找工作的朋友。北京的生活的确压力很大，最起码心累，自己慢慢适应就好了。</p>
<p>不得不提的是拆那ZF的办事效率，我回家转户口，青岛老家来回跑了三四天，竟然还是没有给我搞定，最后说青岛户口已经起出来了，老家还要等十五天之后才可以看到结果，然后才能给我落户口！难道ZF的技术就那么差劲啊！数据库还是不统一的，还是故意要老百姓多跑几次，以调动内需？哎……</p>
<h3>一道javascript正则笔试题目</h3>
<p>在笔试的时候碰到了一道<strong>正则</strong>的题目，自己不会，后来查了很多资料也没找到，经过在Qwrap的QQ群里提问终于明白了是什么回事，特地记录一下。原题大致如下：</p>
<figure class="highlight lang-javascript"><table><tr><td class="gutter"><pre>1
2
3
4
5
6
7
</pre></td><td class="code"><pre><span class="keyword">var</span> a = <span class="keyword">new</span> RegExp(<span class="string">"123"</span>,<span class="string">"g"</span>);
<span class="keyword">var</span> b = <span class="string">"abc#123"</span>;

console.log(a.test(b));<span class="comment">//true</span>
console.log(a.test(b));<span class="comment">//false</span>
console.log(a.test(b));<span class="comment">//true</span>
console.log(a.test(b));<span class="comment">//false</span>
</pre></td></tr></table></figure>

<p>问为什么会输出<code>true</code>，<code>false</code>，<code>true</code>，<code>false</code>？<br>
      
    </div>
    <footer>
      
        
          <div class="alignleft">
            <a href="/2011/04/21/一道js正则笔试题/#more" class="more-link">全文</a>
          </div>
        
        
      
      

      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article class="post">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
      
      
  
    <h1 class="title"><a href="/2011/03/20/最短的domready代码/">最短的DOMReady代码</a></h1>
  

      <time datetime="2011-03-20T09:39:31.000Z"><a href="/2011/03/20/最短的domready代码/">2011年3月20日</a></time>
    </header>
    <div class="entry">
      
        <p>自己的<a href="http://js8.in/677.html" title="一个轻量级的js框架">js框架YQ</a>还没有添加<strong>DOMReady</strong>代码，今天看到国外js牛人Dustin Diaz的<a href="http://dustindiaz.com/smallest-domready-ever" target="_blank">文章</a>，得到了一份最短的DOMReady代码，分享出来：</p>
<figure class="highlight lang-javascript"><table><tr><td class="gutter"><pre>1
2
</pre></td><td class="code"><pre>
<span class="function"><span class="keyword">function</span> <span class="title">r</span><span class="params">(f)</span>{</span>/<span class="keyword">in</span>/.test(document.readyState)?setTimeout(<span class="string">'r('</span>+f+<span class="string">')'</span>,<span class="number">9</span>):f()}
</pre></td></tr></table></figure>

<p>Dustin Diaz放弃了使用IE的<code>document.documentElement.doScroll(&#39;left&#39;)</code>（这也是多数框架的方法，<a href="http://javascript.nwbox.com/IEContentLoaded/" target="_blank">详细介绍</a>）。使用了setTimeout来定时检测<code>document.readyState</code>，<code>document.readyState</code>有以下五种状态：<br>
      
    </div>
    <footer>
      
        
          <div class="alignleft">
            <a href="/2011/03/20/最短的domready代码/#more" class="more-link">全文</a>
          </div>
        
        
      
      

      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article class="post">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
      
      
  
    <h1 class="title"><a href="/2011/03/17/winhttp-winhttprequest-5-1—可以用作抓取的msxml-4-0底层对象/">WinHttp.WinHttpRequest.5.1—可以用作抓取的msxml 4.0底层对象</a></h1>
  

      <time datetime="2011-03-17T13:10:00.000Z"><a href="/2011/03/17/winhttp-winhttprequest-5-1—可以用作抓取的msxml-4-0底层对象/">2011年3月17日</a></time>
    </header>
    <div class="entry">
      
        <p>前些日子在博客园上看到的一篇文章（现在搜索不到了，尽转载的），介绍了下WinHttp.WinHttpRequest.5.1。自己也查了一些资料，写了个vbscript脚本，来添加<a href="http://js8.in/634.html" title="Sina App Engine开发实例：天气预报的定时短信（二）">新浪微博</a>好友。<strong>WinHttp.WinHttpRequest</strong>的介绍可以去微软官方查看，也有个介绍的网站：<a href="http://www.neilstuff.com/winhttp/。感兴趣的可以移步去围观一下。" target="_blank">http://www.neilstuff.com/winhttp/。感兴趣的可以移步去围观一下。</a></p>
<p>简单看一下我改的博客园文章的代码，用于新浪微博自动添加好友，因为是前些日子写的。<a href="http://js8.in/resume.html" title="_blank">申请离职</a>之后，害怕自己的以前的一些代码丢失，特发到网上来备案一下。简单解释在代码中，加上之前的php的<a href="http://js8.in/379.html">curl函数</a>，WinHttp.WinHttpRequest.5.1应该对以后一些研究会有帮助。而且WinHttp.WinHttpRequest也可以设置refer，cookie，user-agent，proxy……，关键是他可以在cmd里面跑，感觉比较酷（当然php也可以做到，但是不熟悉php的可以用js写出来代替curl）。不废话了，直接上代码。</p>
<figure class="highlight lang-javascript"><table><tr><td class="gutter"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
</pre></td><td class="code"><pre>
<span class="function"><span class="keyword">function</span> <span class="title">RemoteCall</span><span class="params">(method, url, param, header)</span>{</span>  
    <span class="keyword">var</span> obj = <span class="keyword">new</span> ActiveXObject(<span class="string">"WinHttp.WinHttpRequest.5.1"</span>);  
    obj.Open(method||<span class="string">"GET"</span>, url, <span class="literal">false</span>);  
    obj.Option(<span class="number">4</span>) = <span class="number">13056</span>;  
    obj.Option(<span class="number">6</span>) = <span class="literal">false</span>;  
    obj.setRequestHeader(<span class="string">"Cookie"</span>, <span class="string">"string"</span>);<span class="comment">//先设置一个cookie，防止出错，见官方文档</span>
    obj.setRequestHeader(<span class="string">"Cookie"</span>,<span class="string">"你的新浪微博cookie"</span>);
    obj.setRequestHeader(<span class="string">"Host"</span>,<span class="string">"t.sina.com.cn"</span>);
    obj.setRequestHeader(<span class="string">"Accept"</span>,<span class="string">"text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8"</span>);
    obj.setRequestHeader(<span class="string">"User-Agent"</span>,<span class="string">"Mozilla/5.0 (Windows; U; Windows NT 5.1; zh-CN; rv:1.9.2.8) Gecko/20100722 Firefox/3.6.8 QQDownload/1.7 FirePHP/0.5"</span>);
    obj.Send(param);  
    <span class="keyword">return</span> obj;  
}
<span class="function"><span class="keyword">function</span> <span class="title">post</span><span class="params">(url,param)</span>{</span>
    <span class="keyword">var</span> obj = <span class="keyword">new</span> ActiveXObject(<span class="string">"WinHttp.WinHttpRequest.5.1"</span>);  
    obj.Open(<span class="string">"POST"</span>, url, <span class="literal">false</span>);  
    obj.Option(<span class="number">4</span>) = <span class="number">13056</span>;  
    obj.Option(<span class="number">6</span>) = <span class="literal">false</span>;  
    obj.setRequestHeader(<span class="string">"Cookie"</span>, <span class="string">"string"</span>);
    obj.setRequestHeader(<span class="string">"Cookie"</span>,<span class="string">"你的新浪微博cookie"</span>);
    obj.setRequestHeader(<span class="string">"Host"</span>,<span class="string">"t.sina.com.cn"</span>);
    obj.setRequestHeader(<span class="string">"Content-Type"</span>,<span class="string">"application/x-www-form-urlencoded; charset=UTF-8"</span>);
    obj.setRequestHeader(<span class="string">"Accept"</span>,<span class="string">"text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8"</span>);
    obj.setRequestHeader(<span class="string">"User-Agent"</span>,<span class="string">"Mozilla/5.0 (Windows; U; Windows NT 5.1; zh-CN; rv:1.9.2.8) Gecko/20100722 Firefox/3.6.8 QQDownload/1.7 FirePHP/0.5"</span>);
    obj.Send(param);  
    <span class="keyword">return</span> obj; 
}
</pre></td></tr></table></figure>

<p>
      
    </div>
    <footer>
      
        
          <div class="alignleft">
            <a href="/2011/03/17/winhttp-winhttprequest-5-1—可以用作抓取的msxml-4-0底层对象/#more" class="more-link">全文</a>
          </div>
        
        
      
      

      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article class="post">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
      
      
  
    <h1 class="title"><a href="/2011/03/15/html5css3版的爱墙上了/">html5+css3版的爱墙上了</a></h1>
  

      <time datetime="2011-03-15T13:15:27.000Z"><a href="/2011/03/15/html5css3版的爱墙上了/">2011年3月15日</a></time>
    </header>
    <div class="entry">
      
        <p>趁着中午休息，发篇文章。不管怎样，从周末开始折腾重构爱墙昨天上了（地址：<a href="http://lovewall.js8.in" title="爱墙" target="_blank"><a href="http://lovewall.js8.in">http://lovewall.js8.in</a></a>，老版：<a href="http://love.js8.in" target="_blank"><a href="http://love.js8.in">http://love.js8.in</a></a>），昨天由于局域网的DNS没有更新，所以也没访问，今天看了下还算比较正常，就是空间速度有点挫，国外的，你懂的！</p>
<p>新版爱墙程序变化：</p>
<ol>
<li>程序全部重构，php采用公司同事开发的<a href="http://raremvc.sinaapp.com" target="_blank">rareMVC框架</a></li>
<li>前端重写，采用html5+css3，所以推荐使用chrome或者FF3.6+体验</li>
<li>javascript代码全部重写，采用了自己的简单框架YQ（<a href="http://js8.in/677.html">暂命名</a>）</li>
<li><p>添加表情功能<br>为啥重构爱墙？：</p>
</li>
<li><p>熟悉php面向对象开发，MVC开发</p>
</li>
<li>实践html5+css3</li>
<li>测试自己的框架YQ（<a href="http://js8.in/js/yq.js">源码</a>）</li>
<li>打发周末时间<br>这个版本的爱墙程序兼容IE6+，chrome，Firefox，主要是练手用的，不再继续维护开发。此程序前端代码全部未压缩处理，欢迎观摩指导</li>
</ol>
<p>ps：今天看了下浏览记录，发现谷歌搜索“jsonp”我的一篇文章竟然排了第一，甚是欣慰~O(∩_∩)O哈哈~</p>

      
    </div>
    <footer>
      
        
        
      
      

      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article class="post">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
      
      
  
    <h1 class="title"><a href="/2011/03/14/转变代码思路：js浏览器判断方法/">转变代码思路：js浏览器判断方法</a></h1>
  

      <time datetime="2011-03-14T13:04:05.000Z"><a href="/2011/03/14/转变代码思路：js浏览器判断方法/">2011年3月14日</a></time>
    </header>
    <div class="entry">
      
        <p>“变则通，通则达”，在coding的时候也要做到，有时候思路往往太过于局限性，对<strong>浏览器判断</strong>方法的实例，来说说代码思路的转变。</p>
<h3>navigator.userAgent分析</h3>
<p>关于<strong>javascript</strong>对浏览器的判断，很早之前我写过一篇文章《js判断浏览器的函数，可区分chrome，safari\》。</p>
<p>YQ框架中也是采用的这个方法，可是后来想到了有位网友说判断火狐的版本号会错误，这是因为火狐的version的判断走了正则，而没有考虑到firefox的，其实不止firefox有这个bug。</p>
<p>首先来看看火狐的<code>navigator.userAgent</code>:<br>这个是我的firefox（3.6.15，却显示3.6.8，不知何解，查看关于也是这个问题：版本不统一）</p>
<blockquote>
<p>Mozilla/5.0 (Windows; U; Windows NT 5.1; zh-CN; rv:1.9.2.8) Gecko/20100722 Firefox/3.6.8 QQDownload/1.7</p>
</blockquote>
<p>根据正则的写法，火狐的版本号应该这样写<code>/Firefox[\/]([\w.]+)/</code><br>而safari的确是类似的：</p>
<blockquote>
<p>……Version/3.1 Safari/525.13</p>
</blockquote>
<p>其中Version为实际的版本号，也是我们常称呼的版本号。</p>
<h3>琢磨</h3>
<p>开始写js判断浏览器的，跟jQuery的<strong>$.browser</strong>一样，可是版本号会出现问题，只不过是加了个chrome判断而已。开始想解决方法，初步想得是通过一个正则对象把浏览器的名称和版本号统一匹配出来，正则对象设置如下：</p>
<figure class="highlight lang-javascript"><table><tr><td class="gutter"><pre>1
2
3
4
5
6
7
</pre></td><td class="code"><pre><span class="keyword">var</span> browserRegExp = {
    ie:<span class="regexp">/(msie)[ ]([\w.]+)/</span>,
    firefox:<span class="regexp">/(firefox)[ |\/]([\w.]+)/</span>,
    chrome:<span class="regexp">/(chrome)[ |\/]([\w.]+)/</span>,
    safari:<span class="regexp">/version[ |\/]([\w.]+)[ ](safari)/</span>,
    opera:<span class="regexp">/(opera)[ |\/]([\w.]+)/</span>
}
</pre></td></tr></table></figure>

<p>
      
    </div>
    <footer>
      
        
          <div class="alignleft">
            <a href="/2011/03/14/转变代码思路：js浏览器判断方法/#more" class="more-link">全文</a>
          </div>
        
        
      
      

      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article class="post">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
      
      
  
    <h1 class="title"><a href="/2011/03/14/自己写的一个轻量级javascript框架的设计模式/">自己写的一个轻量级javascript框架的设计模式</a></h1>
  

      <time datetime="2011-03-13T17:15:39.000Z"><a href="/2011/03/14/自己写的一个轻量级javascript框架的设计模式/">2011年3月14日</a></time>
    </header>
    <div class="entry">
      
        <p>公司一直使用jQuery框架，一些小的项目还是觉得jQuery框架太过于强大了，于是自己周末有空琢磨着写个自己的框架。谈到js的设计模式，不得不说说js的类继承机制，javascript不同于PHP可以轻松的实现类继承，不过javascript的类继承方法还是有的，常见的有构建函数、原型扩展、综合……，也有一些专门写类的函数，例如jQuery的作者有个类继承函数。关于类继承写法可以简单看看<a href="http://kevlindev.com/tutorials/javascript/inheritance/index.htm" target="_blank">这篇文章</a>。</p>
<p>我自己写的框架也不知道叫什么名字，刚开始写的时候随手写了个W（姓拼音，之前写过jQuery弹出框插件<a href="http://js8.in/wbox-jquery">wBox</a>），现在写这篇文章重新整理了一下思想，换了YQ（名字拼音，你懂的~）。</p>
<h3>核心代码</h3>
<p>框架设计的时候尽量做到了支持链式写法，也就是返回<code>this</code>，可以$(selector).handler1().handler2()……无限写下去，只要不是有返回值的就可以继续。包括了event，dom，css，还有fadeIn，fadeOut动画（因为再重构<a href="http://love.js8.in" target="_blank">爱墙</a>[html5+css3]版，所有顺手加上了这个功能）。如果配合sizzle选择器就更牛了！</p>
<p>下面说说框架的核心代码，等完善了之后跟新版html5爱墙一起放出，主要的代码如下：<br>
      
    </div>
    <footer>
      
        
          <div class="alignleft">
            <a href="/2011/03/14/自己写的一个轻量级javascript框架的设计模式/#more" class="more-link">全文</a>
          </div>
        
        
      
      

      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article class="post">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
      
      
  
    <h1 class="title"><a href="/2011/03/03/如何写出高质量的javascript代码/">如何写出高质量的Javascript代码</a></h1>
  

      <time datetime="2011-03-03T08:22:42.000Z"><a href="/2011/03/03/如何写出高质量的javascript代码/">2011年3月3日</a></time>
    </header>
    <div class="entry">
      
        <p>优秀的Stoyan Stefanov在他的新书中（《<strong>Javascript</strong> Patterns》）介绍了很多编写高质量代码的技巧，比如避免使用全局变量，使用单一的var关键字，循环式预存长度等等。</p>
<p>这篇文章不仅仅从代码本身来考虑如何优化编码，也从代码的设计阶段来考虑，包括书写API文档，同事的review，使用JSLint。这些习惯都能帮助你编写更加<strong>高质量</strong>的、更易于理解的、可维护的代码（让你的代码在多年之后仍使你引以为傲）。</p>
<h3>编写可维护的代码</h3>
<p>软件的BUG修复需要花费大量的精力。尤其当代码已经发布之后，随着时间的增长，维护的成本愈发的高。当你一发现BUG的时候，就立即去修复，这时候你的代码还是热乎的，你也不需要回忆，因为就是刚刚写好的。但是当你做了其他任务，几乎完全忘记了这份代码，这时候就需要：</p>
<ol>
<li>重新学习和理解问题</li>
<li>理解代码是如何解决问题的<br>另外一个问题是，在大项目或者大公司里面，经常是解决BUG的人不是产生BUG的人，而且也不是发现BUG的人。所以减少理解代码的时间就是最重要的问题，无论这个代码是你自己以前写的还是团队中的其他成员写的，因为我们都想去搞搞新的有意思的东西，而不是去维护那些个陈旧的代码。</li>
</ol>
<p>还有一个开发中的普遍问题就是，往往读代码的时间比写代码的时间还要多。有时候你钻研一个问题，可以花整整一个下午的时间来考虑代码的编写。这个代码当时是可以工作的，但是随着开发的进行，其他东西发生了很大的变化，这时候也就需要你自己来重新审查修改编写代码。比如：</p>
<ol>
<li>还有BUG没有解决</li>
<li>添加了新的功能</li>
<li>程序需要在新的环境中运行（比如一个新上市的浏览器）</li>
<li>代码有问题</li>
<li>代码需要重写因为修改了架构甚至要使用另一个语言<br>因为这些原因，也许你当时一个下午写好的代码，后面需要花费几周的时间来阅读。所以编写可维护的代码对于软件的成功至关重要。</li>
</ol>
<p>可维护的代码包括：</p>
<ol>
<li>可读性</li>
<li>连续性</li>
<li>预见性</li>
<li>看起来是一个人写的</li>
<li>有文档</li>
<li>最少化全局变量<br>Javascript使用函数来约定作用域。一个在函数内部声明的变量在外部是不可见的。所以，全局变量也就是声明在任何函数之外的或者没有被声明的变量。</li>
</ol>
<p><strong>Javascript</strong>中，在任何函数之外有个可访问的全局对象，每一个你创建的全局变量都是这个对象的一个属性。在浏览器中，为了方便，通常用window来指代这个全局变量。下面的代码就是说明如何创建一个全局变量：</p>
<blockquote>
<figure class="highlight lang-javascript"><table><tr><td class="gutter"><pre>1
2
3
4
5
</pre></td><td class="code"><pre>myglobal = <span class="string">"hello"</span>; <span class="comment">// antipattern</span>
&gt; console.log(myglobal); <span class="comment">// "hello"</span>
&gt; console.log(window.myglobal); <span class="comment">// "hello"</span>
&gt; console.log(window[<span class="string">"myglobal"</span>]); <span class="comment">// "hello"</span>
&gt; console.log(<span class="keyword">this</span>.myglobal); <span class="comment">// "hello</span>
</pre></td></tr></table></figure>

</blockquote>
<h3>全局变量的问题</h3>
<p>全局变量的问题在于，他在你的所有代码或者一个页面中都共享。他们在同一个命名空间下面，这通常会造成变量名冲突–两个同名的变量，但是确实不同的用处。</p>
<p>通常在一些页面中需要引入一些其他人的代码，比如：</p>
<ol>
<li>第三方的JS库</li>
<li>广告伙伴的脚本</li>
<li>第三方的用户行为分析或者统计脚本</li>
<li>不同的组件、按钮等等<br>加入其中一个第三方组件定义了一个全局变量：result。然后在你的程序中，也定义了一个全局变量result。最后的这个result会覆盖点之前的result，这样第三方的脚本就会停止工作。</li>
</ol>
<p>所以，为了对其他的脚本友好，在一个页面中使用越少的全局变量越好。在后面会有一些方法来告诉你如何减少全局变量，比如使用命名空间，或者自执行的匿名函数，但是最好的避免全局变量的方法就是使用var关键字来声明变量。<br>
      
    </div>
    <footer>
      
        
          <div class="alignleft">
            <a href="/2011/03/03/如何写出高质量的javascript代码/#more" class="more-link">全文</a>
          </div>
        
        
      
      

      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article class="post">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
      
      
  
    <h1 class="title"><a href="/2011/02/14/使用xdebug调试php-找出php程序的瓶颈/">使用xdebug调试PHP 找出PHP程序的瓶颈</a></h1>
  

      <time datetime="2011-02-14T15:24:17.000Z"><a href="/2011/02/14/使用xdebug调试php-找出php程序的瓶颈/">2011年2月14日</a></time>
    </header>
    <div class="entry">
      
        <p><strong>xdebug</strong>是PHP的一个扩展应用，有了xdebug就可以轻松的调试PHP程序，有了它，我们就不用使用<code>var_dump()</code>，<code>print_r()</code>之类的傻瓜调试函数了。<br>Xdebug则提供了更多的功能，能全方位的对PHP脚本进行调试。<strong>Xdebug</strong>主要的功能如下：</p>
<ol>
<li>堆栈追踪和函数追踪；</li>
<li>错误信息；</li>
<li>内存分配；</li>
<li>剖析php脚本的信息；</li>
<li>代码覆盖率分析；</li>
<li>远程调试分析；</li>
</ol>
<h3>1、Ubuntu搭建xdebug调试环境</h3>
<h4>安装Xdebug模块</h4>
<p>在终端中使用apt-get安装xdebug，命令如下</p>
<blockquote>
<p>sudo apt-get install php5-dev php-pear<br>sudo apt-get install php5-xdebug<br>然后打开php.ini文件(例如gedit /etc/php5/apache2/php.ini)。进行如下配置；<br>;加载xdebug动态链接库<br>extension=xdebug.so<br>;xdebug分析文件输出路径<br>xdebug.profiler_output_dir = “/var/www/xdebug/”<br>;分析器默认是关闭，调试的时候在url中加入XDEBUG_PROFILE=true即可<br>xdebug.profiler_enable = Off<br>xdebug.profiler_enable_trigger = 1<br>重启apache，这样就可以使用xdebug调试PHP了。</p>
</blockquote>
<h3>2、windows下安装xdebug</h3>
<p>以PHP5.1.4，Windows平台为例（其它PHP版本，其它平台请参看官网文档）：<br>1． 登录www.xdebug.org，在首页右侧有一个Windows modules，选择其中的PHP5.1.2+，下载php_xdebug-5.1.2-2.0.0beta6.dll文件；<br>2． 将下载的php_xdebug-5.1.2-2.0.0beta6.dll放到C:\php5\ext目录，重命名为php_xdebug.dll；<br>3． 编辑php.ini，加入下面几行：</p>
<blockquote>
<p>extension=php_xdebug.dll<br>[Xdebug]<br>xdebug.profiler_enable=on<br>xdebug.trace_output_dir=&quot;I:\Projects\xdebug&quot;<br>xdebug.profiler_output_dir=&quot;I:\Projects\xdebug&quot;<br>xdebug.dump.GET=*<br>xdebug.show_local_vars=1<br>具体参数PHP.ini说明参见ubuntu下的注释。</p>
</blockquote>
<h3>3、使用xdebug进行PHP调试</h3>
<h4>xdebug调试变量更加友好</h4>
<p>Xdebug重写了php里面<code>var_dump()</code>函数。<br>xdebug里的var_dump()给变量对象有不同的颜色，显示类型长度，还可以控制显示层次，显示的方式经过格式化，清晰友好。<br>需要使用此功能，有如下参数需注意。<br>
      
    </div>
    <footer>
      
        
          <div class="alignleft">
            <a href="/2011/02/14/使用xdebug调试php-找出php程序的瓶颈/#more" class="more-link">全文</a>
          </div>
        
        
      
      

      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article class="post">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
      
      
  
    <h1 class="title"><a href="/2011/01/26/使用navigator-geolocation来获取用户的地理位置信息/">使用navigator.geolocation来获取用户的地理位置信息</a></h1>
  

      <time datetime="2011-01-26T15:25:05.000Z"><a href="/2011/01/26/使用navigator-geolocation来获取用户的地理位置信息/">2011年1月26日</a></time>
    </header>
    <div class="entry">
      
        <p>W3C 中新添加了一个名为 <strong>Geolocation</strong>的 API 规范，Geoloaction API的作用就是通过浏览器获取用户的地理位置。我们可以使用<code>navigator.geolocation</code>来简单的获取用户的地理位置信息。本文中将简单介绍下W3C的Geolocation。</p>
<p>Geolocation在javascript的navigator 对象中，我们可以通过 navigator.geolocation 来使用它。不支持 geolocation 的浏览器并不包含这一对象，那么可以通过下面的代码来做能力检测，对不同的浏览器做不同的处理。</p>
<figure class="highlight lang-javascript"><table><tr><td class="gutter"><pre>1
2
3
4
5
</pre></td><td class="code"><pre><span class="keyword">if</span> (navigator.geolocation) {
        alert( <span class="string">' 浏览器支持 geolocation '</span> );
}<span class="keyword">else</span>{
        alert( <span class="string">' 浏览器不支持 geolocation '</span> );
}
</pre></td></tr></table></figure>

<p>在访问 geolocation 对象时，即调用 geolocation 下面的方法时，浏览器会弹出提示，询问用户是否许可网站提供的位置服务，只有在得到用户许可过后，服务才会继续，否则将被停止，在稍后你将会了解到，我们能够捕获到用户拒绝服务的动作。下面这张图分别是 Chrome , Firefox 和 Opera 在初次访问 geolocation 时，给用户的提示：</p>
<p><a href="http://js8.in/672.html/geolocation-warn-2"><img src="/uploads/2011/01/geolocation-warn1-300x186.png" alt="初次使用geolocation时的警告框" title="初次使用geolocation时的警告框"></a></p>
<p>常用的navigator.geolocation对象有以下三种方法：</p>
<ol>
<li>获取当前地理位置：<strong>navigator.geolocation.getCurrentPosition</strong>(success_callback_function, error_callback_function, position_options)</li>
<li>持续获取地理位置：<strong>navigator.geolocation.watchPosition</strong>(success_callback_function, error_callback_function, position_options)</li>
<li><p>清除持续获取地理位置事件：<strong>navigator.geolocation.clearWatch</strong>(watch_position_id)<br>其中success_callback_function为成功之后处理的函数，error_callback_function为失败之后返回的处理函数，参数position_options是配置项，由JSON格式传入：</p>
</li>
<li><p>enableHighAccuracy：true/false，它将告诉浏览器是否启用高精度设备，所谓的高精度设备包含但不局限于前面所提到的 GPS 和 WIFI，值为 true 的时候，浏览器会尝试启用这些设备，默认指为 true，在这种情况下，浏览器会尽可能地进行更为精确的查询，简单地说，如果用户有可用的 GPS 设备，会返回 GPS 设备的查询结果，IP 是最后的选择，对于移动设备来说，网络接入点(基站)或许成为另一个选择，对此我还没有完全了解，但根据测试，即时没有任何额外功能的手机，也能够得到更为精确的查询结果。</p>
</li>
<li>maximumAge：单位毫秒，告诉设备缓存时间，主要用于设备的省电或者节省带宽方面。</li>
<li>timeout：单位毫秒，超时事件，获取位置信息时超出设定的这个时长，将会触发错误，捕获错误的函数将被调用，并且错误码指向TIMEOUT。</li>
</ol>
<p>例如下面的代码：</p>
<figure class="highlight lang-javascript"><table><tr><td class="gutter"><pre>1
2
3
4
</pre></td><td class="code"><pre>
<span class="keyword">var</span> geo=navigator.geolocation.getCurrentPosition(geo_success, geo_error, {enableHighAccuracy:<span class="literal">true</span>, 
    maximumAge:<span class="number">30000</span>, 
    timeout:<span class="number">27000</span>});
</pre></td></tr></table></figure>


      
    </div>
    <footer>
      
        
          <div class="alignleft">
            <a href="/2011/01/26/使用navigator-geolocation来获取用户的地理位置信息/#more" class="more-link">全文</a>
          </div>
        
        
      
      

      <div class="clearfix"></div>
    </footer>
  </div>
</article>





</div></div>
    <aside id="sidebar" class="alignright">
  
<div class="widget tag">
  <h3 class="title">分类</h3>
  <ul class="entry">
  
    <li><a href="/categories/乱七八糟/">乱七八糟</a><small>30</small></li>
  
    <li><a href="/categories/前端开发/">前端开发</a><small>116</small></li>
  
    <li><a href="/categories/后端运维/">后端运维</a><small>27</small></li>
  
    <li><a href="/categories/王婆卖瓜/">王婆卖瓜</a><small>4</small></li>
  
    <li><a href="/categories/读书笔记/">读书笔记</a><small>5</small></li>
  
  </ul>
</div>


  
<div class="widget tagcloud">
  <h3 class="title">标签</h3>
  <ul class="entry clearfix">
  
    <li><a href="/tags/DOM/">DOM<sup>2</sup></a></li>
  
    <li><a href="/tags/IE/">IE<sup>1</sup></a></li>
  
    <li><a href="/tags/IE6/">IE6<sup>2</sup></a></li>
  
    <li><a href="/tags/PPT/">PPT<sup>3</sup></a></li>
  
    <li><a href="/tags/VPS/">VPS<sup>1</sup></a></li>
  
    <li><a href="/tags/ajax/">ajax<sup>5</sup></a></li>
  
    <li><a href="/tags/apache/">apache<sup>1</sup></a></li>
  
    <li><a href="/tags/audio/">audio<sup>2</sup></a></li>
  
    <li><a href="/tags/a标签/">a标签<sup>1</sup></a></li>
  
    <li><a href="/tags/canvas/">canvas<sup>1</sup></a></li>
  
    <li><a href="/tags/chrome/">chrome<sup>3</sup></a></li>
  
    <li><a href="/tags/css/">css<sup>15</sup></a></li>
  
    <li><a href="/tags/eAccelerator/">eAccelerator<sup>1</sup></a></li>
  
    <li><a href="/tags/ecmascript/">ecmascript<sup>3</sup></a></li>
  
    <li><a href="/tags/escape/">escape<sup>1</sup></a></li>
  
    <li><a href="/tags/event/">event<sup>1</sup></a></li>
  
    <li><a href="/tags/express/">express<sup>1</sup></a></li>
  
    <li><a href="/tags/grunt/">grunt<sup>1</sup></a></li>
  
    <li><a href="/tags/handleEvent/">handleEvent<sup>1</sup></a></li>
  
    <li><a href="/tags/html5/">html5<sup>3</sup></a></li>
  
    <li><a href="/tags/iframe/">iframe<sup>1</sup></a></li>
  
    <li><a href="/tags/iptables/">iptables<sup>1</sup></a></li>
  
    <li><a href="/tags/javascript/">javascript<sup>79</sup></a></li>
  
    <li><a href="/tags/linux/">linux<sup>4</sup></a></li>
  
    <li><a href="/tags/livereload/">livereload<sup>1</sup></a></li>
  
    <li><a href="/tags/memcached/">memcached<sup>1</sup></a></li>
  
    <li><a href="/tags/mixjs/">mixjs<sup>1</sup></a></li>
  
    <li><a href="/tags/mysql/">mysql<sup>2</sup></a></li>
  
    <li><a href="/tags/name/">name<sup>1</sup></a></li>
  
    <li><a href="/tags/nginx/">nginx<sup>2</sup></a></li>
  
    <li><a href="/tags/nodejs/">nodejs<sup>7</sup></a></li>
  
    <li><a href="/tags/php/">php<sup>19</sup></a></li>
  
    <li><a href="/tags/session/">session<sup>1</sup></a></li>
  
    <li><a href="/tags/storage/">storage<sup>1</sup></a></li>
  
    <li><a href="/tags/svn/">svn<sup>1</sup></a></li>
  
    <li><a href="/tags/this/">this<sup>1</sup></a></li>
  
    <li><a href="/tags/ueditor/">ueditor<sup>1</sup></a></li>
  
    <li><a href="/tags/uglifyjs/">uglifyjs<sup>1</sup></a></li>
  
    <li><a href="/tags/webbench/">webbench<sup>1</sup></a></li>
  
    <li><a href="/tags/websocket/">websocket<sup>1</sup></a></li>
  
    <li><a href="/tags/web前端开发/">web前端开发<sup>5</sup></a></li>
  
    <li><a href="/tags/windows7技巧/">windows7技巧<sup>1</sup></a></li>
  
    <li><a href="/tags/wordpress/">wordpress<sup>3</sup></a></li>
  
    <li><a href="/tags/xss/">xss<sup>3</sup></a></li>
  
    <li><a href="/tags/严格模式/">严格模式<sup>1</sup></a></li>
  
    <li><a href="/tags/位运算/">位运算<sup>1</sup></a></li>
  
    <li><a href="/tags/作用域/">作用域<sup>3</sup></a></li>
  
    <li><a href="/tags/前端优化/">前端优化<sup>1</sup></a></li>
  
    <li><a href="/tags/前端工具/">前端工具<sup>4</sup></a></li>
  
    <li><a href="/tags/加速器/">加速器<sup>1</sup></a></li>
  
    <li><a href="/tags/压力测试/">压力测试<sup>1</sup></a></li>
  
    <li><a href="/tags/右键/">右键<sup>1</sup></a></li>
  
    <li><a href="/tags/安全/">安全<sup>1</sup></a></li>
  
    <li><a href="/tags/性能/">性能<sup>3</sup></a></li>
  
    <li><a href="/tags/我也八卦/">我也八卦<sup>1</sup></a></li>
  
    <li><a href="/tags/执行环境/">执行环境<sup>1</sup></a></li>
  
    <li><a href="/tags/技巧/">技巧<sup>1</sup></a></li>
  
    <li><a href="/tags/播放器/">播放器<sup>1</sup></a></li>
  
    <li><a href="/tags/数组/">数组<sup>1</sup></a></li>
  
    <li><a href="/tags/标签/">标签<sup>1</sup></a></li>
  
    <li><a href="/tags/模块化/">模块化<sup>2</sup></a></li>
  
    <li><a href="/tags/算法/">算法<sup>1</sup></a></li>
  
    <li><a href="/tags/网络技术/">网络技术<sup>73</sup></a></li>
  
    <li><a href="/tags/虚拟主机/">虚拟主机<sup>1</sup></a></li>
  
    <li><a href="/tags/解耦/">解耦<sup>1</sup></a></li>
  
    <li><a href="/tags/语法限制/">语法限制<sup>1</sup></a></li>
  
    <li><a href="/tags/跨域/">跨域<sup>3</sup></a></li>
  
    <li><a href="/tags/路径/">路径<sup>1</sup></a></li>
  
    <li><a href="/tags/软件心得/">软件心得<sup>3</sup></a></li>
  
  </ul>
</div>



  
</aside>
    <div class="clearfix"></div>
  </div>
  <footer id="footer" class="inner"><div class="alignleft">
  
  &copy; 2013 三水清
  
</div>
<div class="clearfix"></div></footer>
  <script src="http://libs.baidu.com/jquery/2.0.3/jquery.min.js"></script>
<script src="/js/jquery.imagesloaded.min.js"></script>
<script src="/js/gallery.js"></script>


    
        <script type="text/javascript" id="bdshare_js" data="type=tools&amp;uid=6635976" ></script>
        <script type="text/javascript" id="bdshell_js"></script>
        <script type="text/javascript">
        document.getElementById("bdshell_js").src = "http://bdimg.share.baidu.com/static/js/shell_v2.js?cdnversion=" + Math.ceil(new Date()/3600000);
        </script>
    
    



<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
(function($){
  $('.fancybox').fancybox();
})(jQuery);
</script>




    <script type="text/javascript">
    var _bdhmProtocol = (("https:" == document.location.protocol) ? " https://" : " http://");
    document.write(unescape("%3Cscript src='" + _bdhmProtocol + "hm.baidu.com/h.js%3F1c76f5cc8274a56106b13b9c9b1fb046' type='text/javascript'%3E%3C/script%3E"));
    </script>


</body>
</html>